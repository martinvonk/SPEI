<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>spei.si module &#8212; SPEI 0.7.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <script src="../_static/documentation_options.js?v=fe7df9b0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="spei.utils module" href="spei.utils.html" />
    <link rel="prev" title="spei.rai module" href="spei.rai.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-spei.si">
<span id="spei-si-module"></span><h1>spei.si module<a class="headerlink" href="#module-spei.si" title="Link to this heading">¶</a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="spei.si.SI">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">SI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">rv_continuous</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_window</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_zero</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normal_scores_transform</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg_func</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'sum'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mean'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'sum'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#spei.si.SI" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Standardized Index Class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>Series</em>) – The input time series data.</p></li>
<li><p><strong>dist</strong> (<em>ContinuousDist</em>) – The SciPy continuous distribution associated with the data.</p></li>
<li><p><strong>timescale</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Size of the moving window over which the series is summed. If zero, no
summation is performed over the time series. If the time series
frequency is daily, then one would provide timescale=30 for SI1,
timescale=90 for SI3, timescale=180 for SI6 etc.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
<li><p><strong>fit_window</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Window size for fitting data in fit_freq frequency’s unit. Default is
zero in which case only data within the fit_freq is considered. If
larger than zero data data within the window is used to fit the
distribution for the series. fit_window must be a odd number larger
than 3 when used.</p></li>
<li><p><strong>prob_zero</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag indicating whether the probability of zero values in the series is
calculated by the occurence.</p></li>
<li><p><strong>normal_scores_transform</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag to use the normal scores transformation for calculating the
cumulative density function.</p></li>
<li><p><strong>agg_func</strong> (<em>Literal</em><em>[</em><em>'sum'</em><em>, </em><em>'mean'</em><em>]</em><em>, </em><em>default='sum'</em>) – String of the function to use for aggregating the time series if the
timescale is larger than 0. Can either be ‘sum’ or ‘mean’.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI._grouped_year">
<span class="sig-name descname"><span class="pre">_grouped_year</span></span><a class="headerlink" href="#spei.si.SI._grouped_year" title="Link to this definition">¶</a></dt>
<dd><p>Dataframe with all data grouped in a one-year (2000) DataFrame with the
original years as columns</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI._dist_dict">
<span class="sig-name descname"><span class="pre">_dist_dict</span></span><a class="headerlink" href="#spei.si.SI._dist_dict" title="Link to this definition">¶</a></dt>
<dd><p>Dictionary of distributions used to fit the data.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dict[int, <a class="reference internal" href="spei.dist.html#spei.dist.Dist" title="spei.dist.Dist">Dist</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.agg_func">
<span class="sig-name descname"><span class="pre">agg_func</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'sum'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'mean'</span></span><span class="p"><span class="pre">]</span></span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'sum'</span></em><a class="headerlink" href="#spei.si.SI.agg_func" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.cdf">
<span class="sig-name descname"><span class="pre">cdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.SI.cdf" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cumulative density function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.cdf_nsf">
<span class="sig-name descname"><span class="pre">cdf_nsf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.SI.cdf_nsf" title="Link to this definition">¶</a></dt>
<dd><p>Compute the cumulative density function using the Normal Scores
Transform</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.dist">
<span class="sig-name descname"><span class="pre">dist</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Any</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">rv_continuous</span></em><a class="headerlink" href="#spei.si.SI.dist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.fit_distribution">
<span class="sig-name descname"><span class="pre">fit_distribution</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#spei.si.SI.fit_distribution" title="Link to this definition">¶</a></dt>
<dd><p>Fit distribution on the time series per fit_frequency and/or fit_window</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.fit_freq">
<span class="sig-name descname"><span class="pre">fit_freq</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></em><a class="headerlink" href="#spei.si.SI.fit_freq" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.fit_window">
<span class="sig-name descname"><span class="pre">fit_window</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#spei.si.SI.fit_window" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.get_dist">
<span class="sig-name descname"><span class="pre">get_dist</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">date</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Timestamp</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="spei.dist.html#spei.dist.Dist" title="spei.dist.Dist"><span class="pre">Dist</span></a></span></span><a class="headerlink" href="#spei.si.SI.get_dist" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.norm_ppf">
<span class="sig-name descname"><span class="pre">norm_ppf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.SI.norm_ppf" title="Link to this definition">¶</a></dt>
<dd><p>Method to calculate propability point function of normal distribution
based on a cumulative density function of a fitted distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.normal_scores_transform">
<span class="sig-name descname"><span class="pre">normal_scores_transform</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#spei.si.SI.normal_scores_transform" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.pdf">
<span class="sig-name descname"><span class="pre">pdf</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.SI.pdf" title="Link to this definition">¶</a></dt>
<dd><p>Compute the probability density function</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="spei.si.SI.ppf">
<span class="sig-name descname"><span class="pre">ppf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.SI.ppf" title="Link to this definition">¶</a></dt>
<dd><p>Method to calculate the percentile point function
(inverse of cdf — percentiles) of a fitted
distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<em>float</em>) – The quantile value (between 0 and 1) for which to calculate the
percentile point function.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>Series</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.prob_zero">
<span class="sig-name descname"><span class="pre">prob_zero</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">bool</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">False</span></em><a class="headerlink" href="#spei.si.SI.prob_zero" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.series">
<span class="sig-name descname"><span class="pre">series</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">Series</span></em><a class="headerlink" href="#spei.si.SI.series" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="spei.si.SI.timescale">
<span class="sig-name descname"><span class="pre">timescale</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">int</span></em><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="headerlink" href="#spei.si.SI.timescale" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spei.si.sgi">
<span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">sgi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.sgi" title="Link to this definition">¶</a></dt>
<dd><p>Method to compute the Standardized Groundwater Index. Uses
the normal scores transform to calculate the cumulative density function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>pandas.Series</em>) – Pandas time series of the groundwater levels. Time series index
should be a pandas DatetimeIndex.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Bloomfield, J. P. and Marchant, B. P.: Analysis of
groundwater drought building on the standardised precipitation index
approach. Hydrol. Earth Syst. Sci., 17, 4769-4787, 2013.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spei.si.spei">
<span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">spei</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series:</span> <span class="pre">~pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist:</span> <span class="pre">~typing.Any</span> <span class="pre">|</span> <span class="pre">~scipy.stats._distn_infrastructure.rv_continuous</span> <span class="pre">=</span> <span class="pre">&lt;scipy.stats._continuous_distns.fisk_gen</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_zero:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.spei" title="Link to this definition">¶</a></dt>
<dd><p>Method to compute the Standardized Precipitation Evaporation Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>pandas.Series</em>) – Pandas time series of the precipitation. Time series index
should be a pandas DatetimeIndex.</p></li>
<li><p><strong>dist</strong> (<em>scipy.stats.rv_continuous</em>) – Can be any continuous distribution from the scipy.stats library.
However, for the SPEI generally the log-logistic (fisk) probability
density function is recommended. Other appropriate choices could be
the lognormal or PearsonIII distribution.</p></li>
<li><p><strong>timescale</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Size of the moving window over which the series is summed. If zero, no
summation is performed over the time series. If the time series
frequency is daily, then one would provide timescale=30 for SI1,
timescale=90 for SI3, timescale=180 for SI6 etc.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
<li><p><strong>fit_window</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Window size for fitting data in fit_freq frequency’s unit. Default is
zero in which case only data within the fit_freq is considered. If
larger than zero data data within the window is used to fit the
distribution for the series. fit_window must be a odd number larger
than 3 when used.</p></li>
<li><p><strong>prob_zero</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag indicating whether the probability of zero values in the series is
calculated by the occurence.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Vicente-Serrano S.M., Beguería S., López-Moreno J.I.:
A Multi-scalar drought index sensitive to global warming:
The Standardized Precipitation Evapotranspiration Index.
Journal of Climate, 23, 1696-1718, 2010.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spei.si.spi">
<span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">spi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series:</span> <span class="pre">~pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist:</span> <span class="pre">~typing.Any</span> <span class="pre">|</span> <span class="pre">~scipy.stats._distn_infrastructure.rv_continuous</span> <span class="pre">=</span> <span class="pre">&lt;scipy.stats._continuous_distns.gamma_gen</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_zero:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.spi" title="Link to this definition">¶</a></dt>
<dd><p>Method to compute the Standardized Precipitation Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>pandas.Series</em>) – Pandas time series of the precipitation. Time series index
should be a pandas DatetimeIndex.</p></li>
<li><p><strong>dist</strong> (<em>scipy.stats.rv_continuous</em>) – Can be any continuous distribution from the scipy.stats library.
However, for the SPI generally the Gamma probability density
function is recommended. Other appropriate choices could be the
lognormal, log-logistic (fisk) or PearsonIII distribution.</p></li>
<li><p><strong>timescale</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Size of the moving window over which the series is summed. If zero, no
summation is performed over the time series. If the time series
frequency is daily, then one would provide timescale=30 for SI1,
timescale=90 for SI3, timescale=180 for SI6 etc.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
<li><p><strong>fit_window</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Window size for fitting data in fit_freq frequency’s unit. Default is
zero in which case only data within the fit_freq is considered. If
larger than zero data data within the window is used to fit the
distribution for the series. fit_window must be a odd number larger
than 3 when used.</p></li>
<li><p><strong>prob_zero</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Option to correct the distribution if x=0 is not in probability density
function. E.g. the case with the Gamma distriubtion. If True, the
probability of zero values in the series is calculated by the
occurence.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>LLoyd-Hughes, B. and Saunders, M.A.: A drought climatology for Europe.
International Journal of Climatology, 22, 1571-1592, 2002.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spei.si.ssfi">
<span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">ssfi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series:</span> <span class="pre">~pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist:</span> <span class="pre">~typing.Any</span> <span class="pre">|</span> <span class="pre">~scipy.stats._distn_infrastructure.rv_continuous</span> <span class="pre">=</span> <span class="pre">&lt;scipy.stats._continuous_distns.genextreme_gen</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_zero:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.ssfi" title="Link to this definition">¶</a></dt>
<dd><p>Method to compute the Standardized StreamFlow Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>pandas.Series</em>) – Pandas time series of the precipitation. Time series index
should be a pandas DatetimeIndex.</p></li>
<li><p><strong>dist</strong> (<em>scipy.stats.rv_continuous</em>) – Can be any continuous distribution from the scipy.stats library.
However, for the SSFI generally the gamma probability density function
is recommended. Other choices could be the normal, lognormal,
pearsonIII, GEV or Gen-Logistic distribution or any distribution deemed
appropriate.</p></li>
<li><p><strong>timescale</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Size of the moving window over which the series is summed. If zero, no
summation is performed over the time series. If the time series
frequency is daily, then one would provide timescale=30 for SI1,
timescale=90 for SI3, timescale=180 for SI6 etc.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
<li><p><strong>fit_window</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Window size for fitting data in fit_freq frequency’s unit. Default is
zero in which case only data within the fit_freq is considered. If
larger than zero data data within the window is used to fit the
distribution for the series. fit_window must be a odd number larger
than 3 when used.</p></li>
<li><p><strong>prob_zero</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag indicating whether the probability of zero values in the series is
calculated by the occurence.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Vicente-Serrano, S. M., J. I. López-Moreno, S. Beguería, J. Lorenzo-Lacruz,
C. Azorin-Molina, and E. Morán-Tejeda. Accurate Computation of a Streamflow
Drought Index. Journal of Hydrologic Engineering 17 (2): 318-332. 2012.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="spei.si.ssmi">
<span class="sig-prename descclassname"><span class="pre">spei.si.</span></span><span class="sig-name descname"><span class="pre">ssmi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">series:</span> <span class="pre">~pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist:</span> <span class="pre">~typing.Any</span> <span class="pre">|</span> <span class="pre">~scipy.stats._distn_infrastructure.rv_continuous</span> <span class="pre">=</span> <span class="pre">&lt;scipy.stats._continuous_distns.beta_gen</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timescale:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_freq:</span> <span class="pre">str</span> <span class="pre">|</span> <span class="pre">None</span> <span class="pre">=</span> <span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_window:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prob_zero:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">True</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Series</span></span></span><a class="headerlink" href="#spei.si.ssmi" title="Link to this definition">¶</a></dt>
<dd><p>Method to compute the Standardized Soil Moisture Index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>series</strong> (<em>pandas.Series</em>) – Pandas time series of the precipitation. Time series index
should be a pandas DatetimeIndex.</p></li>
<li><p><strong>dist</strong> (<em>scipy.stats.rv_continuous</em>) – Can be any continuous distribution from the scipy.stats library.
However, for the SSMI generally the beta probability density function
is recommended. Other choices could be the normal or ECDF distribution
or any distribution deemed appropriate.</p></li>
<li><p><strong>timescale</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Size of the moving window over which the series is summed. If zero, no
summation is performed over the time series. If the time series
frequency is daily, then one would provide timescale=30 for SI1,
timescale=90 for SI3, timescale=180 for SI6 etc.</p></li>
<li><p><strong>fit_freq</strong> (<em>str</em><em>, </em><em>optional</em><em>, </em><em>default=None</em>) – Frequency for fitting the distribution. Default is None in which case
the frequency of the series is inferred. If this fails a monthly
frequency is used.</p></li>
<li><p><strong>fit_window</strong> (<em>int</em><em>, </em><em>optional</em><em>, </em><em>default=0</em>) – Window size for fitting data in fit_freq frequency’s unit. Default is
zero in which case only data within the fit_freq is considered. If
larger than zero data data within the window is used to fit the
distribution for the series. fit_window must be a odd number larger
than 3 when used.</p></li>
<li><p><strong>prob_zero</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Flag indicating whether the probability of zero values in the series is
calculated by the occurence.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.Series</p>
</dd>
</dl>
<p class="rubric">References</p>
<p>Carrão. H., Russo, S., Sepulcre-Canto, G., Barbosa, P.: An empirical standardized
soil moisture index for agricultural drought assessment from remotely sensed data.
International Journal of Applied Earth Observation and Geoinformation, 48, 2016.</p>
</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">SPEI</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Exampless</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">spei</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="spei.html">spei package</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="modules.html">spei</a><ul>
  <li><a href="spei.html">spei package</a><ul>
      <li>Previous: <a href="spei.rai.html" title="previous chapter">spei.rai module</a></li>
      <li>Next: <a href="spei.utils.html" title="next chapter">spei.utils module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Martin Vonk.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/_api/spei.si.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>